!function(t,e){if("function"==typeof define&&define.amd)define(["exports","module","diff-match-patch","dom-anchor-text-position"],e);else if("undefined"!=typeof exports&&"undefined"!=typeof module)e(exports,module,require("diff-match-patch"),require("dom-anchor-text-position"));else{var n={exports:{}};e(n.exports,n,t.DiffMatchPatch,t.TextPositionAnchor),t.TextQuoteAnchor=n.exports}}(this,function(t,e,n,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=i(n),u=i(r),f=32,h=new RegExp("(.|[\r\n]){1,"+String(f)+"}","g"),c=f,x=function(){function t(e,n){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(o(this,t),void 0===e)throw new Error('missing required parameter "root"');if(void 0===n)throw new Error('missing required parameter "exact"');this.root=e,this.exact=n,this.prefix=r.prefix,this.suffix=r.suffix}return a(t,[{key:"toRange",value:function(t){return this.toPositionAnchor(t).toRange()}},{key:"toSelector",value:function(){var t={type:"TextQuoteSelector",exact:this.exact};return void 0!==this.prefix&&(t.prefix=this.prefix),void 0!==this.suffix&&(t.suffix=this.suffix),t}},{key:"toPositionAnchor",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.hint,n=this.root,r=new s["default"];r.Match_Distance=2*n.textContent.length;var i=this.exact.match(h),o=void 0===e?n.textContent.length/2|0:e,a=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,c=-1,x=void 0!==this.prefix,m=void 0!==this.suffix,d=!1;x&&(c=r.match_main(n.textContent,this.prefix,o),c>-1&&(o=c+this.prefix.length,d=!0)),m&&!d&&(c=r.match_main(n.textContent,this.suffix,o+this.exact.length),c>-1&&(o=c-this.exact.length));var l=i.shift();if(c=r.match_main(n.textContent,l,o),!(c>-1))throw new Error("no match found");a=c,o=f=a+l.length;var g=function(t,e){var i=r.match_main(n.textContent,e,t.loc);if(-1===i)throw new Error("no match found");return t.loc=i+e.length,t.start=Math.min(t.start,i),t.end=Math.max(t.end,i+e.length),t};r.Match_Distance=64;var v=i.reduce(g,{start:a,end:f,loc:o});return new u["default"](n,v.start,v.end)}}],[{key:"fromRange",value:function(t,e){if(void 0===e)throw new Error('missing required parameter "range"');var n=u["default"].fromRange(t,e);return this.fromPositionAnchor(n)}},{key:"fromSelector",value:function(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return new t(e,n.exact,n)}},{key:"fromPositionAnchor",value:function(e){var n=e.root,r=e.start,i=e.end,o=n.textContent.substr(r,i-r),a=Math.max(0,r-c),s=n.textContent.substr(a,r-a),u=Math.min(n.textContent.length,i+c),f=n.textContent.substr(i,u-i);return new t(n,o,{prefix:s,suffix:f})}}]),t}();e.exports=x});
//# sourceMappingURL=TextQuoteAnchor.min.js.map
